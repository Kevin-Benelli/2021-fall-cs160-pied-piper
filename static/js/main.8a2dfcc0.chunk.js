(this["webpackJsonpstocked-client"]=this["webpackJsonpstocked-client"]||[]).push([[0],{194:function(e,t,n){},202:function(e,t,n){},222:function(e,t,n){},249:function(e,t,n){},250:function(e,t,n){},251:function(e,t,n){},254:function(e,t,n){},255:function(e,t,n){},263:function(e,t,n){},293:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),o=n(21),s=n.n(o),r=(n(194),n(195),n(196),n(197),n(198),n(199),n(200),n(201),n(12)),i=(n(202),n(44)),l=n.n(i),j=n(56),u=n(17),h=n(301),d=n(54),b=n.p+"static/media/logo.7f424a7c.png",m=n(46),f=n.n(m),O=n(65),g=n(34),p=n(139),x=n(83),v=n(94);n(222);var w=n(2),S=function(e){var t=e.setLoggedInUsername,n=Object(a.useState)(""),c=Object(r.a)(n,2),o=c[0],s=c[1],i=Object(a.useState)(!1),j=Object(r.a)(i,2),u=j[0],d=j[1],b=Object(a.useState)(""),m=Object(r.a)(b,2),S=m[0],N=m[1],k=Object(a.useState)(null),D=Object(r.a)(k,2),y=D[0],C=D[1];function M(e,t){return P.apply(this,arguments)}function P(){return(P=Object(O.a)(f.a.mark((function e(n,a){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault();try{l.a.post("http://localhost:5001/post_".concat(a),{username:o,password:S}).then((function(e){e.data.error?C(e.data.message):(C(null),t(o))}))}catch(c){console.log("Yo something went wrong: %s",c)}case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var T=Object(w.jsx)(p.a,{content:"".concat(u?"Hide":"Show"," Password"),placement:"right",children:Object(w.jsx)(h.a,{icon:u?"unlock":"lock",intent:g.a.WARNING,minimal:!0,onClick:function(){d(!u)}})}),L=Object(w.jsx)("div",{className:"login center",children:Object(w.jsxs)("form",{children:[Object(w.jsx)(h.f,{className:"username",placeholder:"Username",onChange:function(e){return s(e.target.value)},value:o}),Object(w.jsx)(h.f,{className:"password",placeholder:"Password",onChange:function(e){return N(e.target.value)},value:S,rightElement:T,type:u?"text":"password"}),Object(w.jsx)(h.a,{className:"login-submit",onClick:function(e){M(e,"login")},children:" Login "}),Object(w.jsx)(h.a,{className:"create-account-submit",onClick:function(e){M(e,"create_account")},children:" Create Account "}),Object(w.jsx)("div",{style:{color:v.Colors.RED1,marginTop:"5px"},children:y})]})});return Object(w.jsx)(x.a,{placement:"bottom",content:L,children:Object(w.jsx)(h.a,{intent:g.a.PRIMARY,icon:"log-in",text:"Login",tabIndex:0})})},N=(n(249),n(250),function(e){var t=e.loggedInUsername,n=e.setLoggedInUsername;var a=Object(w.jsxs)("div",{className:"userdropdown center",children:[Object(w.jsx)(h.a,{className:"logout",onClick:function(e){n(null)},children:" Logout "}),Object(w.jsx)("br",{}),"To be continued"]});return Object(w.jsx)(x.a,{placement:"bottom",content:a,children:Object(w.jsx)(h.a,{intent:g.a.PRIMARY,icon:"user",text:t,tabIndex:0})})}),k=(n(251),function(){var e=Object(a.useState)(""),t=Object(r.a)(e,2),n=t[0],c=t[1];function o(e){var t="/2021-fall-cs160-pied-piper/#/ticker/".concat(n);console.log(t),window.open(t,"_self")}var s=Object(w.jsx)(h.a,{icon:"search",minimal:!0,onClick:o});return Object(w.jsx)("div",{className:"search-bar",children:Object(w.jsx)("form",{onSubmit:o,children:Object(w.jsx)(h.f,{className:"search-input",placeholder:"Search",leftElement:s,onChange:function(e){return c(e.target.value)}})})})}),D=function(e){var t=e.loggedInUsername,n=e.setLoggedInUsername;return Object(w.jsx)("div",{className:"center",children:Object(w.jsx)("div",{className:"header",children:Object(w.jsxs)(h.j,{className:"header-navbar",children:[Object(w.jsx)(h.k,{align:d.a.LEFT,children:Object(w.jsx)(j.b,{to:"/",children:Object(w.jsx)("img",{src:b,className:"header-logo",alt:"logo"})})}),Object(w.jsxs)(h.k,{align:d.a.RIGHT,children:[Object(w.jsx)(k,{}),t&&Object(w.jsx)(N,{loggedInUsername:t,setLoggedInUsername:n}),!t&&Object(w.jsx)(S,{setLoggedInUsername:n})]})]})})})},y=(n(254),n(136)),C=n(137),M=n(130),P=n(131),T=n(132),L=n(138),I=n(135),E=(n(255),n.p+"static/media/loading.60616635.gif"),R=n(302),F=n(140),U=["updateMousePos","draw"];var A=new Intl.DateTimeFormat("en",{timeStyle:"short",hour12:!1,dateStyle:"short"});var H=function(e){var t,n,c,o,s=Object(a.useState)(null),i=Object(r.a)(s,2),j=i[0],u=i[1],d=Object(a.useState)(null),b=Object(r.a)(d,2),m=b[0],f=b[1],O=Object(a.useState)(!1),g=Object(r.a)(O,2),p=g[0],v=g[1],S=Object(a.useState)("30"),N=Object(r.a)(S,2),k=N[0],D=N[1],y=e.ticker.toUpperCase(),C=new Date,M=(t=C,n=-1,c=0,o=0,new Date(t.getFullYear()+o,t.getMonth()+c,Math.min(t.getDate()+n,new Date(t.getFullYear()+o,t.getMonth()+c+1,0).getDate()))),P=Object(a.useState)(Math.floor(M.getTime()/1e3)),T=Object(r.a)(P,2),L=T[0],I=T[1],E=Object(a.useState)(Math.floor(C.getTime()/1e3)),U=Object(r.a)(E,2),H=U[0],Y=U[1];Object(a.useEffect)((function(){l.a.get("http://localhost:5001/chart_data",{params:{resolution:k,symbol:y,from:L,to:H}}).then((function(e){u(e.data.chartData),f(e.data.error),v(!0)}))}),[k,y,L,H]);var J={showArrowButtons:!0,useAmPm:!1};return Object(w.jsxs)("div",{className:"chartArea center",children:[Object(w.jsx)("div",{className:"chart",children:Object(w.jsx)(_,{chartData:j,error:m,loaded:p,width:"800px",height:"500px",symbol:y,resolution:k,from:L,to:H})}),p&&null===m&&Object(w.jsxs)("div",{className:"chartSettings",children:[Object(w.jsxs)(h.g,{children:["From:",Object(w.jsx)(x.a,{placement:"top",content:Object(w.jsx)(R.a,{className:"chart-from-datepicker",onChange:function(e){I(Math.floor(e.getTime()/1e3))},timePickerProps:J,timePrecision:F.b.SECOND}),children:Object(w.jsx)(h.a,{text:A.format(1e3*L)})})]}),Object(w.jsxs)(h.g,{children:["To:",Object(w.jsx)(x.a,{placement:"top",content:Object(w.jsx)(R.a,{className:"chart-from-datepicker",onChange:function(e){Y(Math.floor(e.getTime()/1e3))},timePickerProps:J,timePrecision:F.b.SECOND}),children:Object(w.jsx)(h.a,{text:A.format(1e3*H)})})]}),Object(w.jsxs)(h.g,{children:["Resolution: ",Object(w.jsxs)("div",{className:"bp3-html-select chart-resolution",children:[Object(w.jsxs)("select",{className:"chart-resolution-select",onChange:function(e){return D(e.target.value)},children:[Object(w.jsx)("option",{value:"1",children:"1"}),Object(w.jsx)("option",{value:"5",children:"5"}),Object(w.jsx)("option",{value:"15",children:"15"}),Object(w.jsx)("option",{value:"30",selected:!0,children:"30"}),Object(w.jsx)("option",{value:"60",children:"60"}),Object(w.jsx)("option",{value:"D",children:"D"}),Object(w.jsx)("option",{value:"W",children:"W"}),Object(w.jsx)("option",{value:"M",children:"M"})]}),Object(w.jsx)("span",{className:"bp3-icon bp3-icon-double-caret-vertical"})]})]})]})]})},_=function(e){Object(L.a)(n,e);var t=Object(I.a)(n);function n(e){var a;return Object(P.a)(this,n),(a=t.call(this,e)).draw=function(e,t){var n="#ffffff",c=n,o=e.canvas.width,s=e.canvas.height,r=o-60,i=s-40;e.clearRect(0,0,o,s),e.fillStyle="#222222",e.fillRect(0,0,o,s);var l=o-60;e.fillStyle="#2b2b43",e.fillRect(l,0,2,s),e.fillStyle="#ffffff";e.font="15px Georgia";var j,u,h=a.getDisplayedPrices(),d=0;e.textAlign="center";for(var b=0;b<h.length;b++){var m=h[b],f=l+30,O=i/h.length*b+15+5;0===b?j=O:b===h.length-1&&(u=O),Math.abs(O-d)>=25&&(e.fillText(m.toFixed(2),f,O),d=O)}for(var g=a.props.chartData.candles,p=g.c.length,x=(r-40)/p,v=Math.max(x/20,1),w=0,S=[],N=0;N<p;N++){var k=g.o[N],D=g.c[N],y=g.h[N],C=g.l[N],P=g.t[N],T=(g.v[N],a.getHeightOfPrice(k,j,u)),L=a.getHeightOfPrice(D,j,u),I=a.getHeightOfPrice(y,j,u),E=a.getHeightOfPrice(C,j,u),R=void 0;R=k<D?"#26a69a":k>D?"#ee5350":"#808080",e.fillStyle=R;var F=N*x+5,U=x-5,H=F+U/2-v/2;e.fillRect(F,Math.min(T,L),U,Math.abs(T-L)),e.fillRect(H,I,v,E-I),S.push({timestamp:P,close:D,closeHeight:L,open:k,openHeight:T,high:y,highHeight:I,low:C,lowHeight:E,xRange:[F,F+U],middlePos:H});var _=new Date(1e3*P);if(["1","5","15","30","60"].includes(a.props.resolution)){if(_.getMinutes()%5===0&&Math.abs(H-w)>=50){e.fillStyle=c;var Y=void 0;Y=0===_.getDate()?_.toLocaleDateString(void 0,{month:"short"}):_.toTimeString().slice(0,5),e.fillText(Y,H,s-20),w=H}}else if(Math.abs(H-w)>=50){e.fillStyle=c;var J=void 0;0===_.getDate()?J=_.toLocaleDateString(void 0,{month:"short"}):["D","W"].includes(a.props.resolution)?J=_.toLocaleDateString("en-US",{day:"numeric",month:"numeric"}):"M"===a.props.resolution&&(J=_.toLocaleDateString("en-US",{month:"short",year:"2-digit"})),e.fillText(J,H,s-20),w=H}}var W=a.state,X=W.mouseX,B=W.mouseY;if(X&&B){e.setLineDash([8,6]),e.strokeStyle="#758696",e.beginPath(),e.moveTo(X,B),e.lineTo(0,B),e.stroke(),e.beginPath(),e.moveTo(X,B),e.lineTo(r,B),e.stroke(),e.beginPath(),e.moveTo(X,B),e.lineTo(X,0),e.stroke(),e.beginPath(),e.moveTo(X,B),e.lineTo(X,s),e.stroke(),e.setLineDash([]);var G,q=Number.MAX_SAFE_INTEGER,z=null,K=Object(M.a)(S);try{for(K.s();!(G=K.n()).done;){var Q=G.value,V=Math.abs(X-Q.middlePos);V<q&&(q=V,z=Q)}}catch(ie){K.e(ie)}finally{K.f()}if(z){var Z=z,$=Z.timestamp,ee=Z.open,te=Z.close,ne=Z.low,ae=Z.high,ce=new Date(1e3*$);e.fillStyle="green",e.textAlign="left",e.fillText("Time: "+A.format(ce)+", Open: "+ee.toFixed(2)+", Close: "+te.toFixed(2)+", Low: "+ne.toFixed(2)+", High: "+ae.toFixed(2),5,40)}}e.fillStyle="#ffffff",e.textAlign="left";var oe=new Date(1e3*a.props.from),se=new Date(1e3*a.props.to),re=a.props.symbol+" from "+A.format(oe)+" to "+A.format(se)+", Resolution: "+a.props.resolution;e.fillText(re,5,20)},a.getHeightOfPrice=function(e,t,n){var c,o,s=a.props.chartData.computed,r=s.max,i=s.min;return(o=[n,t])[0]+(e-(c=[i,r])[0])*(o[1]-o[0])/(c[1]-c[0])},a.getDisplayedPrices=function(){for(var e=a.props.chartData.computed,t=e.max,n=e.min,c=[],o=Math.ceil(t);o>n;o-=1)c.push(o);return c.push(Math.floor(n)),c},a.updateMousePos=function(e,t){a.setState({mouseX:e,mouseY:t})},a.state={zoomLevel:1,mouseX:null,mouseY:null},a}return Object(T.a)(n,[{key:"render",value:function(){var e=this.props,t=e.width,n=e.height,a=e.loaded,o=e.error;return Object(w.jsx)("div",{className:"center",children:Object(w.jsxs)("div",{className:"chart",style:{width:t,height:n},children:[a&&null===o&&Object(w.jsx)(Y,{draw:this.draw,width:t,height:n,style:{width:t,height:n},updateMousePos:this.updateMousePos}),a&&null!==o&&Object(w.jsxs)(c.a.Fragment,{children:[" ",Object(w.jsx)("div",{children:"Error 404: ticker not found"}),Object(w.jsxs)("div",{children:["More info: ",o]})]}),!a&&Object(w.jsx)("img",{src:E,alt:"Loading..."})]})})}}]),n}(c.a.Component),Y=function(e){var t=e.updateMousePos,n=e.draw,c=Object(C.a)(e,U),o=Object(a.useRef)(null);return Object(a.useEffect)((function(){var e=o.current;e.addEventListener("mousemove",(function(n){var a=e.getBoundingClientRect(),c=Math.round(n.clientX-a.left),o=Math.round(n.clientY-a.top);t(c,o)})),e.addEventListener("mouseleave",(function(e){t(null,null)}));var a,c=e.getContext("2d"),s=0;return function e(){s++,n(c,s),a=window.requestAnimationFrame(e)}(),function(){window.cancelAnimationFrame(a)}}),[n]),Object(w.jsx)("canvas",Object(y.a)({ref:o},c))},J=function(){var e=Object(u.e)().ticker;return Object(w.jsx)(H,{ticker:e})},W=(n(263),function(){return Object(w.jsx)("div",{className:"center",children:Object(w.jsx)("div",{children:Object(w.jsx)("h1",{className:"settings-body",children:"Welcome to the settings page."})})})}),X=n(134),B=n(84),G=function(e){var t=e.socket,n=e.username,c=e.chatroom,o=Object(a.useState)(""),s=Object(r.a)(o,2),i=s[0],l=s[1],j=Object(a.useState)([]),u=Object(r.a)(j,2),h=u[0],d=u[1],b=function(){var e=Object(O.a)(f.a.mark((function e(){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===i){e.next=5;break}return a={chatroom:c,author:n,message:i,time:new Date(Date.now()).getHours()+":"+new Date(Date.now()).getMinutes()+":"+new Date(Date.now()).getSeconds()},e.next=4,t.emit("send_message",a);case 4:d((function(e){return[].concat(Object(B.a)(e),[a])}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){t.on("receive_message",(function(e){console.log(e),d((function(t){return[].concat(Object(B.a)(t),[e])}))}))}),[t]),Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:"chat-room-header",children:Object(w.jsxs)("p",{children:[" Live Chat Room for ",c.toUpperCase()," "]})}),Object(w.jsx)("div",{className:"chat-room-body",children:h.map((function(e){return Object(w.jsx)("div",{className:"message",id:n===e.author?"user-self":"user-other",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:"message-content",children:Object(w.jsx)("p",{children:e.message})}),Object(w.jsx)("div",{className:"message-meta",children:Object(w.jsxs)("p",{id:"sender_time",children:[e.author," Sent: ",e.time]})})]})})}))}),Object(w.jsxs)("div",{className:"chat-room-footer",children:[Object(w.jsx)("input",{type:"text",placeholder:"Lets Talk Stocks...",onChange:function(e){l(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&b()}}),Object(w.jsx)("button",{onClick:b,children:"\u25ba"})]})]})},q=Object(X.io)("http://localhost:5001"),z=function(){var e=Object(a.useState)(""),t=Object(r.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(""),s=Object(r.a)(o,2),i=s[0],l=s[1],j=Object(a.useState)(!1),u=Object(r.a)(j,2),h=u[0],d=u[1];return Object(w.jsx)("div",{className:"center",children:h?Object(w.jsx)(G,{socket:q,username:n,chatroom:i}):Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{children:" Join Stocked Chat Room Now! "}),Object(w.jsx)("input",{type:"text",placeholder:"Enter Name",onChange:function(e){c(e.target.value.toUpperCase())}}),Object(w.jsx)("input",{type:"text",placeholder:"Enter Ticker",onChange:function(e){l(e.target.value.toUpperCase())}}),Object(w.jsx)("button",{onClick:function(){""!==n&&""!==i&&(q.emit("join_chat_room",i),d(!0))},children:" Join Chat Room "})]})})};var K=function(){var e=Object(a.useState)(""),t=Object(r.a)(e,2),n=t[0],o=t[1];Object(a.useEffect)((function(){l.a.get("http://localhost:5001/home").then((function(e){o(e.data)}))}),[]);var s=function(e,t){var n=c.a.useState((function(){var n=window.localStorage.getItem(t);return null!==n?JSON.parse(n):e})),a=Object(r.a)(n,2),o=a[0],s=a[1];return c.a.useEffect((function(){window.localStorage.setItem(t,JSON.stringify(o))}),[t,o]),[o,s]}(null,"username"),i=Object(r.a)(s,2),h=i[0],d=i[1];return Object(w.jsx)("div",{className:"center",children:Object(w.jsx)("div",{className:"App",children:Object(w.jsxs)(j.a,{basename:"/2021-fall-cs160-pied-piper",children:[Object(w.jsx)(D,{loggedInUsername:h,setLoggedInUsername:d}),h&&Object(w.jsx)("div",{children:"This div shows when a user is logged in."}),!h&&Object(w.jsx)("div",{children:"This div shows when there's no logged in user."}),Object(w.jsx)(u.a,{path:"/",children:n}),Object(w.jsx)(u.a,{path:"/ticker/:ticker",children:Object(w.jsx)(J,{})}),Object(w.jsx)(u.a,{path:"/settings",children:Object(w.jsx)(W,{})}),Object(w.jsx)(u.a,{path:"/chat",children:Object(w.jsx)(z,{})})]})})})},Q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,303)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,o=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),o(e),s(e)}))};s.a.render(Object(w.jsx)(c.a.StrictMode,{children:Object(w.jsx)(K,{})}),document.getElementById("root")),Q()}},[[293,1,2]]]);
//# sourceMappingURL=main.8a2dfcc0.chunk.js.map