(this["webpackJsonpstocked-client"]=this["webpackJsonpstocked-client"]||[]).push([[0],{342:function(e,t,n){},350:function(e,t,n){},370:function(e,t,n){},397:function(e,t,n){},398:function(e,t,n){},401:function(e,t,n){},402:function(e,t,n){},403:function(e,t,n){},411:function(e,t,n){},412:function(e,t,n){},599:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),s=n(28),o=n.n(s),r=(n(342),n(343),n(344),n(345),n(346),n(347),n(348),n(349),n(13)),i=(n(350),n(57)),l=n.n(i),j=n(48),u=n(21),h=n(607),d=n(90),b=n.p+"static/media/logo.7f424a7c.png",m=n(52),f=n.n(m),O=n(75),g=n(59),p=n(287),x=n(169),v=n(180);n(370);var w=n(1),S=function(e){var t=e.setLoggedInUsername,n=Object(a.useState)(""),c=Object(r.a)(n,2),s=c[0],o=c[1],i=Object(a.useState)(!1),j=Object(r.a)(i,2),u=j[0],d=j[1],b=Object(a.useState)(""),m=Object(r.a)(b,2),S=m[0],N=m[1],C=Object(a.useState)(null),k=Object(r.a)(C,2),y=k[0],D=k[1];function T(e,t){return M.apply(this,arguments)}function M(){return(M=Object(O.a)(f.a.mark((function e(n,a){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault();try{l.a.post("http://localhost:5001/post_".concat(a),{username:s,password:S}).then((function(e){e.data.error?D(e.data.message):(D(null),t(s))}))}catch(c){console.log("Yo something went wrong: %s",c)}case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var I=Object(w.jsx)(p.a,{content:"".concat(u?"Hide":"Show"," Password"),placement:"right",children:Object(w.jsx)(h.a,{icon:u?"unlock":"lock",intent:g.a.WARNING,minimal:!0,onClick:function(){d(!u)}})}),P=Object(w.jsx)("div",{className:"login center",children:Object(w.jsxs)("form",{children:[Object(w.jsx)(h.f,{className:"username",placeholder:"Username",onChange:function(e){return o(e.target.value)},value:s}),Object(w.jsx)(h.f,{className:"password",placeholder:"Password",onChange:function(e){return N(e.target.value)},value:S,rightElement:I,type:u?"text":"password"}),Object(w.jsx)(h.a,{className:"login-submit",onClick:function(e){T(e,"login")},children:" Login "}),Object(w.jsx)(h.a,{className:"create-account-submit",onClick:function(e){T(e,"create_account")},children:" Create Account "}),Object(w.jsx)("div",{style:{color:v.Colors.RED1,marginTop:"5px"},children:y})]})});return Object(w.jsx)(x.a,{placement:"bottom",content:P,children:Object(w.jsx)(h.a,{intent:g.a.PRIMARY,icon:"log-in",text:"Login",tabIndex:0})})},N=(n(397),n(398),function(e){var t=e.loggedInUsername,n=e.setLoggedInUsername;var a=Object(w.jsx)("div",{className:"userdropdown center",children:Object(w.jsxs)(j.a,{basename:"/",children:[Object(w.jsx)(h.a,{className:"toggle",onClick:function(){document.body.classList.toggle("light-mode")},children:" Light Mode Toggle "}),Object(w.jsx)("br",{}),Object(w.jsxs)(j.b,{to:"/",children:[Object(w.jsx)(h.a,{children:"Home"}),Object(w.jsx)("br",{})]}),Object(w.jsxs)(j.b,{to:"/settings",children:[Object(w.jsx)(h.a,{children:"Settings"}),Object(w.jsx)("br",{})]}),Object(w.jsxs)(j.b,{to:"/chat",children:[Object(w.jsx)(h.a,{children:"Chat"}),Object(w.jsx)("br",{})]}),Object(w.jsx)(h.a,{className:"mystery",onClick:function(e){return window.location.href="https://www.youtube.com/watch?v=dQw4w9WgXcQ"},children:" FREE BITCOIN CLICK HERE!! "}),Object(w.jsx)("br",{}),Object(w.jsx)(h.a,{className:"logout",onClick:function(e){n(null)},children:" Logout "}),Object(w.jsx)("br",{}),"To be continued"]})});return Object(w.jsx)(x.a,{placement:"bottom",content:a,children:Object(w.jsx)(h.a,{intent:g.a.PRIMARY,icon:"user",text:t,tabIndex:0})})}),C=(n(401),function(){var e=Object(a.useState)(""),t=Object(r.a)(e,2),n=t[0],c=t[1];function s(e){var t="/2021-fall-cs160-pied-piper/#/ticker/".concat(n);console.log(t),window.open(t,"_self")}var o=Object(w.jsx)(h.a,{icon:"search",minimal:!0,onClick:s});return Object(w.jsx)("div",{className:"search-bar",children:Object(w.jsx)("form",{onSubmit:s,children:Object(w.jsx)(h.f,{className:"search-input",placeholder:"Search",leftElement:o,onChange:function(e){return c(e.target.value)}})})})}),k=function(e){var t=e.loggedInUsername,n=e.setLoggedInUsername;return Object(w.jsx)("div",{className:"center",children:Object(w.jsx)("div",{className:"header",children:Object(w.jsxs)(h.j,{className:"header-navbar",children:[Object(w.jsx)(h.k,{align:d.a.LEFT,children:Object(w.jsx)(j.b,{to:"/",children:Object(w.jsx)("img",{src:b,className:"header-logo",alt:"logo"})})}),Object(w.jsxs)(h.k,{align:d.a.RIGHT,children:[Object(w.jsx)(C,{}),t&&Object(w.jsx)(N,{loggedInUsername:t,setLoggedInUsername:n}),!t&&Object(w.jsx)(S,{setLoggedInUsername:n})]})]})})})},y=(n(402),n(284)),D=n(285),T=n(265),M=n(266),I=n(267),P=n(286),L=n(283),E=(n(403),n.p+"static/media/loading.60616635.gif"),R=n(608),U=n(288),F=["updateMousePos","draw"];var A=new Intl.DateTimeFormat("en",{timeStyle:"short",hour12:!1,dateStyle:"short"});var H=function(e){var t,n,c,s,o=Object(a.useState)(null),i=Object(r.a)(o,2),j=i[0],u=i[1],d=Object(a.useState)(null),b=Object(r.a)(d,2),m=b[0],f=b[1],O=Object(a.useState)(!1),g=Object(r.a)(O,2),p=g[0],v=g[1],S=Object(a.useState)("30"),N=Object(r.a)(S,2),C=N[0],k=N[1],y=e.ticker.toUpperCase(),D=new Date,T=(t=D,n=-1,c=0,s=0,new Date(t.getFullYear()+s,t.getMonth()+c,Math.min(t.getDate()+n,new Date(t.getFullYear()+s,t.getMonth()+c+1,0).getDate()))),M=Object(a.useState)(Math.floor(T.getTime()/1e3)),I=Object(r.a)(M,2),P=I[0],L=I[1],E=Object(a.useState)(Math.floor(D.getTime()/1e3)),F=Object(r.a)(E,2),H=F[0],Y=F[1];Object(a.useEffect)((function(){l.a.get("http://localhost:5001/chart_data",{params:{resolution:C,symbol:y,from:P,to:H}}).then((function(e){u(e.data.chartData),f(e.data.error),v(!0)}))}),[C,y,P,H]);var B={showArrowButtons:!0,useAmPm:!1};return Object(w.jsxs)("div",{className:"chartArea center",children:[Object(w.jsx)("div",{className:"chart",children:Object(w.jsx)(_,{chartData:j,error:m,loaded:p,width:"800px",height:"500px",symbol:y,resolution:C,from:P,to:H})}),p&&null===m&&Object(w.jsxs)("div",{className:"chartSettings",children:[Object(w.jsxs)(h.g,{children:["From:",Object(w.jsx)(x.a,{placement:"top",content:Object(w.jsx)(R.a,{className:"chart-from-datepicker",onChange:function(e){L(Math.floor(e.getTime()/1e3))},timePickerProps:B,timePrecision:U.b.SECOND}),children:Object(w.jsx)(h.a,{text:A.format(1e3*P)})})]}),Object(w.jsxs)(h.g,{children:["To:",Object(w.jsx)(x.a,{placement:"top",content:Object(w.jsx)(R.a,{className:"chart-from-datepicker",onChange:function(e){Y(Math.floor(e.getTime()/1e3))},timePickerProps:B,timePrecision:U.b.SECOND}),children:Object(w.jsx)(h.a,{text:A.format(1e3*H)})})]}),Object(w.jsxs)(h.g,{children:["Resolution: ",Object(w.jsxs)("div",{className:"bp3-html-select chart-resolution",children:[Object(w.jsxs)("select",{className:"chart-resolution-select",onChange:function(e){return k(e.target.value)},children:[Object(w.jsx)("option",{value:"1",children:"1"}),Object(w.jsx)("option",{value:"5",children:"5"}),Object(w.jsx)("option",{value:"15",children:"15"}),Object(w.jsx)("option",{value:"30",selected:!0,children:"30"}),Object(w.jsx)("option",{value:"60",children:"60"}),Object(w.jsx)("option",{value:"D",children:"D"}),Object(w.jsx)("option",{value:"W",children:"W"}),Object(w.jsx)("option",{value:"M",children:"M"})]}),Object(w.jsx)("span",{className:"bp3-icon bp3-icon-double-caret-vertical"})]})]})]})]})},_=function(e){Object(P.a)(n,e);var t=Object(L.a)(n);function n(e){var a;return Object(M.a)(this,n),(a=t.call(this,e)).draw=function(e,t){var n="#ffffff",c=n,s=e.canvas.width,o=e.canvas.height,r=s-60,i=o-40;e.clearRect(0,0,s,o),e.fillStyle="#222222",e.fillRect(0,0,s,o);var l=s-60;e.fillStyle="#2b2b43",e.fillRect(l,0,2,o),e.fillStyle="#ffffff";e.font="15px Georgia";var j,u,h=a.getDisplayedPrices(),d=0;e.textAlign="center";for(var b=0;b<h.length;b++){var m=h[b],f=l+30,O=i/h.length*b+15+5;0===b?j=O:b===h.length-1&&(u=O),Math.abs(O-d)>=25&&(e.fillText(m.toFixed(2),f,O),d=O)}for(var g=a.props.chartData.candles,p=g.c.length,x=(r-40)/p,v=Math.max(x/20,1),w=0,S=[],N=0;N<p;N++){var C=g.o[N],k=g.c[N],y=g.h[N],D=g.l[N],M=g.t[N],I=(g.v[N],a.getHeightOfPrice(C,j,u)),P=a.getHeightOfPrice(k,j,u),L=a.getHeightOfPrice(y,j,u),E=a.getHeightOfPrice(D,j,u),R=void 0;R=C<k?"#26a69a":C>k?"#ee5350":"#808080",e.fillStyle=R;var U=N*x+5,F=x-5,H=U+F/2-v/2;e.fillRect(U,Math.min(I,P),F,Math.abs(I-P)),e.fillRect(H,L,v,E-L),S.push({timestamp:M,close:k,closeHeight:P,open:C,openHeight:I,high:y,highHeight:L,low:D,lowHeight:E,xRange:[U,U+F],middlePos:H});var _=new Date(1e3*M);if(["1","5","15","30","60"].includes(a.props.resolution)){if(_.getMinutes()%5===0&&Math.abs(H-w)>=50){e.fillStyle=c;var Y=void 0;Y=0===_.getDate()?_.toLocaleDateString(void 0,{month:"short"}):_.toTimeString().slice(0,5),e.fillText(Y,H,o-20),w=H}}else if(Math.abs(H-w)>=50){e.fillStyle=c;var B=void 0;0===_.getDate()?B=_.toLocaleDateString(void 0,{month:"short"}):["D","W"].includes(a.props.resolution)?B=_.toLocaleDateString("en-US",{day:"numeric",month:"numeric"}):"M"===a.props.resolution&&(B=_.toLocaleDateString("en-US",{month:"short",year:"2-digit"})),e.fillText(B,H,o-20),w=H}}var J=a.state,X=J.mouseX,W=J.mouseY;if(X&&W){e.setLineDash([8,6]),e.strokeStyle="#758696",e.beginPath(),e.moveTo(X,W),e.lineTo(0,W),e.stroke(),e.beginPath(),e.moveTo(X,W),e.lineTo(r,W),e.stroke(),e.beginPath(),e.moveTo(X,W),e.lineTo(X,0),e.stroke(),e.beginPath(),e.moveTo(X,W),e.lineTo(X,o),e.stroke(),e.setLineDash([]);var G,K=Number.MAX_SAFE_INTEGER,Q=null,V=Object(T.a)(S);try{for(V.s();!(G=V.n()).done;){var q=G.value,z=Math.abs(X-q.middlePos);z<K&&(K=z,Q=q)}}catch(ie){V.e(ie)}finally{V.f()}if(Q){var Z=Q,$=Z.timestamp,ee=Z.open,te=Z.close,ne=Z.low,ae=Z.high,ce=new Date(1e3*$);e.fillStyle="green",e.textAlign="left",e.fillText("Time: "+A.format(ce)+", Open: "+ee.toFixed(2)+", Close: "+te.toFixed(2)+", Low: "+ne.toFixed(2)+", High: "+ae.toFixed(2),5,40)}}e.fillStyle="#ffffff",e.textAlign="left";var se=new Date(1e3*a.props.from),oe=new Date(1e3*a.props.to),re=a.props.symbol+" from "+A.format(se)+" to "+A.format(oe)+", Resolution: "+a.props.resolution;e.fillText(re,5,20)},a.getHeightOfPrice=function(e,t,n){var c,s,o=a.props.chartData.computed,r=o.max,i=o.min;return(s=[n,t])[0]+(e-(c=[i,r])[0])*(s[1]-s[0])/(c[1]-c[0])},a.getDisplayedPrices=function(){for(var e=a.props.chartData.computed,t=e.max,n=e.min,c=[],s=Math.ceil(t);s>n;s-=1)c.push(s);return c.push(Math.floor(n)),c},a.updateMousePos=function(e,t){a.setState({mouseX:e,mouseY:t})},a.state={zoomLevel:1,mouseX:null,mouseY:null},a}return Object(I.a)(n,[{key:"render",value:function(){var e=this.props,t=e.width,n=e.height,a=e.loaded,s=e.error;return Object(w.jsx)("div",{className:"center",children:Object(w.jsxs)("div",{className:"chart",style:{width:t,height:n},children:[a&&null===s&&Object(w.jsx)(Y,{draw:this.draw,width:t,height:n,style:{width:t,height:n},updateMousePos:this.updateMousePos}),a&&null!==s&&Object(w.jsxs)(c.a.Fragment,{children:[" ",Object(w.jsx)("div",{children:"Error 404: ticker not found"}),Object(w.jsxs)("div",{children:["More info: ",s]})]}),!a&&Object(w.jsx)("img",{src:E,alt:"Loading..."})]})})}}]),n}(c.a.Component),Y=function(e){var t=e.updateMousePos,n=e.draw,c=Object(D.a)(e,F),s=Object(a.useRef)(null);return Object(a.useEffect)((function(){var e=s.current;e.addEventListener("mousemove",(function(n){var a=e.getBoundingClientRect(),c=Math.round(n.clientX-a.left),s=Math.round(n.clientY-a.top);t(c,s)})),e.addEventListener("mouseleave",(function(e){t(null,null)}));var a,c=e.getContext("2d"),o=0;return function e(){o++,n(c,o),a=window.requestAnimationFrame(e)}(),function(){window.cancelAnimationFrame(a)}}),[n]),Object(w.jsx)("canvas",Object(y.a)({ref:s},c))},B=function(){var e=Object(u.e)().ticker;return Object(w.jsx)(H,{ticker:e})},J=(n(411),function(e){var t=e.loggedInUsername,n=e.setLoggedInUsername,c=Object(a.useState)(null),s=Object(r.a)(c,2),o=s[0],i=s[1],j=Object(a.useState)(!1),u=Object(r.a)(j,2),d=u[0],b=(u[1],Object(a.useState)(null)),m=Object(r.a)(b,2),g=m[0],p=m[1],x=Object(a.useState)(null),S=Object(r.a)(x,2),N=S[0],C=S[1];function k(){return(k=Object(O.a)(f.a.mark((function e(a){var c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.preventDefault();try{c={username:o,password:g},l.a.post("http://localhost:5001/post_update_account",{usernameToUpdate:t,newValues:c}).then((function(e){e.data.error?C(e.data.message):(C(null),c.username&&n(o))}))}catch(s){console.log("Yo something went wrong: %s",s)}case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(w.jsxs)("div",{className:"settings",children:[Object(w.jsx)("h1",{children:"Account Info"}),Object(w.jsxs)("form",{children:[Object(w.jsx)(h.f,{className:"username",placeholder:"Username",onChange:function(e){return i(e.target.value)},defaultValue:t}),Object(w.jsx)(h.f,{className:"password",placeholder:"Password",onChange:function(e){return p(e.target.value)},type:d?"text":"password"}),Object(w.jsx)(h.a,{className:"update-account-submit",onClick:function(e){!function(e){k.apply(this,arguments)}(e)},children:" Update Info "}),Object(w.jsx)("div",{style:{color:v.Colors.RED1,marginTop:"5px"},children:N})]})]})}),X=(n(412),n(269)),W=n(170),G=n(282),K=function(e){var t=e.socket,n=e.username,c=e.chatroom,s=Object(a.useState)(""),o=Object(r.a)(s,2),i=o[0],l=o[1],j=Object(a.useState)([]),u=Object(r.a)(j,2),h=u[0],d=u[1],b=function(){var e=Object(O.a)(f.a.mark((function e(){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===i){e.next=5;break}return a={chatroom:c,author:n,message:i,time:new Date(Date.now()).getHours()+":"+new Date(Date.now()).getMinutes()+":"+new Date(Date.now()).getSeconds()},e.next=4,t.emit("send_message",a);case 4:d((function(e){return[].concat(Object(W.a)(e),[a])}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){t.on("receive_message",(function(e){console.log(e),d((function(t){return[].concat(Object(W.a)(t),[e])}))}))}),[t]),Object(w.jsx)("div",{children:Object(w.jsxs)("div",{className:"chat-room-window",children:[Object(w.jsx)("div",{className:"chat-room-header-title",children:Object(w.jsxs)("p",{children:[" Live Chat Room for ",c.toUpperCase()," "]})}),Object(w.jsx)("div",{className:"chat-room-body",children:Object(w.jsx)(G.a,{className:"message-container",children:h.map((function(e){return Object(w.jsx)("div",{className:"message",id:n===e.author?"user-self":"user-other",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:"message-content",children:Object(w.jsx)("p",{children:e.message})}),Object(w.jsx)("div",{className:"message-meta",children:Object(w.jsxs)("p",{id:"sender_and_time",children:[e.author," Sent: ",e.time]})})]})})}))})}),Object(w.jsxs)("div",{className:"chat-room-footer",children:[Object(w.jsx)("input",{className:"chat-room-footer-message-field",type:"text",placeholder:"Lets Talk Stocks...",onChange:function(e){l(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&b()}}),Object(w.jsx)("button",{onClick:b,children:"\u25ba"})]})]})})},Q=Object(X.io)("http://localhost:5001"),V=function(){var e=Object(a.useState)(""),t=Object(r.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(""),o=Object(r.a)(s,2),i=o[0],l=o[1],j=Object(a.useState)(!1),u=Object(r.a)(j,2),h=u[0],d=u[1];return Object(w.jsx)("div",{className:"center",children:h?Object(w.jsx)(K,{socket:Q,username:n,chatroom:i}):Object(w.jsxs)("div",{className:"joinChatRoom",children:[Object(w.jsx)("h3",{children:" Join Stocked Chat Room Now! "}),Object(w.jsx)("input",{className:"joinChatInputField",type:"text",placeholder:"Enter Name",onChange:function(e){c(e.target.value.toUpperCase())}}),Object(w.jsx)("input",{className:"joinChatInputField",type:"text",placeholder:"Enter Ticker",onChange:function(e){l(e.target.value.toUpperCase())}}),Object(w.jsx)("button",{className:"joinChatRoomButton",onClick:function(){""!==n&&""!==i&&(Q.emit("join_chat_room",i),d(!0))},children:" Join Chat Room "})]})})};var q=function(){var e=Object(a.useState)(""),t=Object(r.a)(e,2),n=t[0],s=t[1];Object(a.useEffect)((function(){l.a.get("http://localhost:5001/home").then((function(e){s(e.data)}))}),[]);var o=function(e,t){var n=c.a.useState((function(){var n=window.localStorage.getItem(t);return null!==n?JSON.parse(n):e})),a=Object(r.a)(n,2),s=a[0],o=a[1];return c.a.useEffect((function(){window.localStorage.setItem(t,JSON.stringify(s))}),[t,s]),[s,o]}(null,"username"),i=Object(r.a)(o,2),h=i[0],d=i[1];return Object(w.jsx)("div",{className:"center",children:Object(w.jsx)("div",{className:"App",children:Object(w.jsxs)(j.a,{basename:"/2021-fall-cs160-pied-piper",children:[Object(w.jsx)(k,{loggedInUsername:h,setLoggedInUsername:d}),h&&Object(w.jsx)("div",{children:"This div shows when a user is logged in."}),!h&&Object(w.jsx)("div",{children:"This div shows when there's no logged in user."}),Object(w.jsx)(u.a,{path:"/",children:n}),Object(w.jsx)(u.a,{path:"/ticker/:ticker",children:Object(w.jsx)(B,{})}),Object(w.jsx)(u.a,{path:"/settings",children:Object(w.jsx)(J,{loggedInUsername:h,setLoggedInUsername:d})}),Object(w.jsx)(u.a,{path:"/chat",children:Object(w.jsx)(V,{})})]})})})},z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,609)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,o=t.getTTFB;n(e),a(e),c(e),s(e),o(e)}))};o.a.render(Object(w.jsx)(c.a.StrictMode,{children:Object(w.jsx)(q,{})}),document.getElementById("root")),z()}},[[599,1,2]]]);
//# sourceMappingURL=main.21edec69.chunk.js.map